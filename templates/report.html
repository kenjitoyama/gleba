{% extends "base.html" %}

{% if default_page %}
  {% block extrahead %}
  <script type="text/javascript" src="/static/js/jquery.min.js"></script>
  <script type="text/javascript" src="/static/js/jquery-ui/js/jquery-ui-1.8.12.custom.min.js"></script>
  <link rel="stylesheet" href="/static/js/jquery-ui/css/smoothness/jquery-ui-1.8.12.custom.css" type="text/css" media="screen" title="Base"/>
  <script type="text/javascript">
    function submitForm(report_type) {
        var form = $("#"+report_type+"report_form");
        var form_url = form.attr("action");
        var selected_value = $("#"+report_type+"menu").val();
        form_url = report_type.substring(0, report_type.length-1)+"/" + selected_value + "/";
        form.attr("action", form_url);
        form.append($("#startDate"));
        form.append($("#endDate"));
        form.submit();
    }

    function submitAllPickerForm() {
        var form = $("#all_picker_report_form")    
        form.append($("#startDate"));
        form.append($("#endDate"));
        form.submit();
    }

    Date.format = 'dd/mm/yyyy';
    $(function() {
        $(".dateField").datepicker({dateFormat: 'dd-mm-yy'});
    });
  </script>
  {% endblock %}
{% endif %} 

{% block content %}
    {% if report_type_picker %}
    <h1>Picker Report :: {{ picker.firstName }} {{ picker.lastName }}</h1> 
    <table><tr><td>	<img src="/static/media/graphs/{{ graph_filename }}"/></td>
      <td>
        <div>	
          <table>
            <tr><td><h4>Date</h4></td><td><h4>Mushrooms Picked (kg)</h4></td><td><h4>Daily Average</h4></td></tr>
          {% for date,weight,dailyAverage in data %}
            <tr><td>{{date}}</td><td>{{weight}}</td><td>{{dailyAverage}}</td></tr>
          {% endfor %}
          </table>
        </div>
      </td>
    </table>
    {% endif %}

    {% if report_type_room %}
        <h1>Room Report :: {{ room.number }}</h1>  
        <table><tr><td>	<img src="/static/media/graphs/{{ graph_filename }}"/></td>
            <td>
                <div>	
                    <table>
                        <tr><td><h4>Date</h4></td><td><h4>Mushrooms Picked (kg)</h4></td></tr>
                    {% for date,weight in data %}
                        <tr><td>{{date}}</td><td>{{weight}}</td></tr>
                    {% endfor %}
                    </table>
                </div>
            </td>
        </table>
    {% endif %}

    {% if report_type_flush %}
        <h1>Flush Report :: {{ flush }}</h1> 
        <table><tr><td>	<img src="/static/media/graphs/{{ graph_filename }}"/></td>
            <td>
                <div>	
                    <table>
                        <tr><td><h4>Date</h4></td><td><h4>Mushrooms Picked (kg)</h4></td></tr>
                    {% for date,weight in data %}
                        <tr><td>{{date}}</td><td>{{weight}}</td></tr>
                    {% endfor %}
                    </table>
                </div>
            </td>
        </table>
        <div id="total_paragraph">
            Total: {{total}}
        </div>
    {% endif %}

    {% if report_type_crop %}
        <h1>Crop Report :: {{ crop }}</h1> 
        <table><tr><td>	<img src="/static/media/graphs/{{ graph_filename }}"/></td>
            <td>
                <div>	
                    <table>
                        <tr><td><h4>Date</h4></td><td><h4>Mushrooms Picked (kg)</h4></td></tr>
                    {% for date,weight in data %}
                        <tr><td>{{date}}</td><td>{{weight}}</td></tr>
                    {% endfor %}
                    </table>
                </div>
            </td>
        </table>
        <div id="total_paragraph">
            Total: {{total}}
        </div>
    {% endif %}

    {% if report_type_all_pickers %}
        <h1>Overall Picking ({{ startDate }} - {{endDate}})</h1> 
            <div>	
                    <table>
                        <thead>
                            <tr>
                                <td>
                                    <h4>
                                        <a href="?sort=fName&startDate={{startDate}}&endDate={{endDate}}">First Name</a>
                                    </h4>
                                </td>
                                <td>
                                    <h4>
                                        <a href="?sort=lName&startDate={{startDate}}&endDate={{endDate}}">Last Name</a>
                                    </h4>
                                </td>
                                <td>
                                    <h4>
                                        <a href="?sort=totalPicked&startDate={{startDate}}&endDate={{endDate}}">Mushrooms Picked (kg)</a>
                                    </h4>
                                </td>
                                <td>
                                    <h4>
                                        <a href="?sort=kpi&startDate={{startDate}}&endDate={{endDate}}">Mushrooms Picked/Hour Worked (kg/hr)</a>
                                    </h4>
                                </td>
                                <td>
                                    <h4>
                                        <a href="?sort=avgBox&startDate={{startDate}}&endDate={{endDate}}">Average Initial Box Weight (kg)</a>
                                    </h4>
                                </td>
                            </tr>
                        </thead>
                    {% comment %}
                        data is a list of lists containing [p.firstName,p.lastName,p.totalPicked, p.kpi, p.avgBoxWeight]
                        for each picker p
                    {% endcomment %}
                        <tbody>
                        {% for i in data  %}
                            <tr><td>{{ i.0 }}</td> <td>{{ i.1 }}</td><td>{{ i.2 }}</td><td>{{ i.3 }}</td><td>{{ i.4 }}</td></tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
    {% endif %}

    {% if default_page %}
    <div>
      <h2>Picker</h2>
      <form name="picker_form" action="picker/" method="post" id="picker_report_form">
        <select name="picker" id="picker_menu">
          {% for picker in picker_list %}
          <option value={{ picker.id }}>{{ picker.id }} - {{ picker.firstName }} {{ picker.lastName }}</option>
          {% endfor %}
        </select><br/>
        <label for="startDate">Start Date</label>
        <input name="startDate" class="dateField" type="text"><br/>
        <label for="endDate">End Date</label>
        <input name="endDate" class="dateField" type="text"><br/>
        <input type="submit" onClick="submitForm('picker_')" value="Submit"/><br/>
      </form>
    </div>
    
    <div>
        <h2>All Pickers</h2>
        <form name="all_picker_form" action="picker/" method="POST" id="all_picker_report_form">
            <label for="startDate">Start Date</label>
            <input name="startDate" class="dateField" type="text"><br/>
            <label for="endDate">End Date</label>
            <input name="endDate" class="dateField" type="text"><br/>
            <input type="submit" onClick="submitAllPickerForm()" value="Submit" ><br/>
        </form>
    </div>
        
    <div>
        <h2>Flush</h2>
        <form name="flush_form" action="flush/" method="post" id="flush_report_form">
            <label for="flush">Flush ID</label>
            <input type="text" name="flush" id="flush_menu"><br/>
            <label for="startDate">Start Date</label>
            <input name="startDate" class="dateField" type="text"><br/>
            <label for="endDate">End Date</label>
            <input name="endDate" class="dateField" type="text"><br/>
            <input type="submit" onClick="submitForm('flush_')" value="Submit"/><br/>
        </form>
    </div>

    <div>
        <h2>Crop</h2>
        <form name="crop_form" action="crop/" method="post" id="crop_report_form">
            <label for="crop">Crop ID</label>
            <input type="text" name="crop" id="crop_menu"><br/>
            <label for="startDate">Start Date</label>
            <input name="startDate" class="dateField" type="text"><br/>
            <label for="endDate">End Date</label>
            <input name="endDate" class="dateField" type="text"><br/>
            <input type="submit" onClick="submitForm('crop_')" value="Submit"/>
        </form>
    </div>

    <div>
        <h2>Room</h2>
        <form name="room_form" action="room/" method="post" id="room_report_form">
            <label for="room">Room Number</label>
            <select name="room" id="room_menu">
                {% for room in room_list %}
                <option value={{ room.number }}>{{ room.number }}</option>
                {% endfor %}
            </select><br/>
            <label for="startDate">Start Date</label>
            <input name="startDate" class="dateField" type="text"><br/>
            <label for="endDate">End Date</label>
            <input name="endDate" class="dateField" type="text"><br/>
            <input type="submit" onClick="submitForm('room_')" value="Submit"/>
        </form>
    </div>
    {% endif %}
    {{ debug }}
{% endblock %}
